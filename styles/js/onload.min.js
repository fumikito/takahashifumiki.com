jQuery(document).ready(function($){function t(){var t;t=$(".margin").width()<760?window.innerHeight-50:$(window).height()-120,$("#to-top").css("top",t)}function e(t){if(!$(this).hasClass("tip-toggle")){if($(this).parents(".quotescollection_randomquote").length>0)return;var e="";if($(this).attr("cite")?e=$(this).attr("cite").toString():$(this).attr("title")?e=$(this).attr("title").toString():$(this).attr("alt")?e=$(this).attr("alt").toString():$(this).hasClass("tip")&&(e=$(this).text().toString()),e.length<1)return!1;switch(this.nodeName.toLowerCase()){case"q":e="<strong>引用元</strong><br />"+e;break;case"abbr":e="<strong>略語</strong><br />"+e;break;case"acronym":e="<strong>頭字語</strong><br />"+e}if($("#tip-container td.content").html(e),void 0!==document.ontouchstart){var n=$(this).width()/2,a=$(this).offset(),i=$(window).height()/2+$(window).scrollTop(),o=$(window).width()/2,r=a.left+(a.left>o?-1*($("#tip-container").width()+n):n),s=a.top+(a.top>i?-1*($("#tip-container").height()+n):n);$("#tip-container").css({top:s,left:r})}return v.fadeIn("fast"),$(this).addClass("tip-toggle"),!0}$(this).removeClass("tip-toggle"),v.fadeOut("fast")}var n=$("#login-button");/fumikicustomer=1/.test(document.cookie)&&($(".account__logged-out").remove(),n.attr("href",n.attr("data-href"))),(/Firefox/.test(navigator.userAgent)||/MSIE/.test(navigator.userAgent)&&!/MSIE (5|6|7|8|9)\.0/.test(navigator.userAgent))&&$("body").addClass("non-filter-blur"),/MSIE 10/.test(navigator.userAgent)&&$("body").addClass("non-ms-filter"),$("p.message").each(function(t,e){var n=!1;$(e).hasClass("warning")?n="fa fa-warning":$(e).hasClass("success")?n="fa fa-check-circle":$(e).hasClass("notice")&&(n="fa fa-lightbulb-o"),n&&$(e).prepend('<i class="'+n+'"></i>')}),Modernizr.touch&&($("#footer-menu-toggle").click(function(t){t.preventDefault(),$(this).toggleClass("toggle")}),$(".header--main .menu > li > a").click(function(t){var e=$(this);e.next("ul").length&&(e.hasClass("toggle")||($(".header--main .men > li > a").removeClass("toggle"),e.addClass("toggle"),t.preventDefault()))}));var a;$("#toggle-menu").click(function(t){t.preventDefault(),a||(a=$('<div class="header__mobile"><div class="header__mobile--container"></div></div>'),a.find(".header__mobile--container").append($(".header__logo")),a.find(".header__mobile--container").append($(".header--main .nav-menu")),$("body").append(a)),a.toggleClass("toggle"),$(this).toggleClass("toggle"),$(this).hasClass("toggle")&&a.find(".header__mobile--container").height($(window).height()-60)}),$("#sorter").submit(function(t){var e=$(this).find("input[name=s]"),n=$(this).find("select[name=cat]"),a=$(this).find("input[name=tag]"),i=$(this).find("select[name=order]"),o=$(this).find("select[name=orderby]");"-1"===n.val()&&n.prop("disabled",!0),""===a.val()&&a.prop("disabled",!0),"date"===o.val()&&o.prop("disabled",!0)}),$("#sorter-toggle").click(function(t){t.preventDefault(),$("#sorter").toggleClass("toggle")});var o="この部分はネタバレなどの「筆者が表示しない方が良いと判断した内容」を含みます。表示してよろしいですか？";$(".netabare, .netabare-inline").each(function(t,e){if($(e).hasClass("netabare")){var n=$('<a class="netabare-opener button" href="#" data-index="'+(t+1)+'"><i class="fa-folder-open"></i>ネタバレ表示</a>'),a=$(e).height()/2*-1;$(e).after(n),n.click(function(t){if(t.preventDefault(),confirm(o)){$(e).removeClass("netabare").removeClass("non-filter-blur"),$(e).effect&&$(e).effect("highlight",{},1e3);try{ga("send",{hitType:"event",eventCategory:"netabare",eventAction:window.location.pathname,eventLabel:$(this).attr("data-index"),eventValue:1})}catch(t){}$(this).remove()}}).css({top:a+"px"})}else $(e).hasClass("netabare-inline")&&$(e).click(function(e){if(confirm(o)){$(this).removeClass("netabare-inline").effect("highlight",{},1e3).unbind("click");try{ga("send",{hitType:"event",eventCategory:"netabare",eventAction:window.location.pathname,eventLabel:t+1,eventValue:1})}catch(e){}}})});var r=$(".desc-box-front"),s,d,c,f=function(){var t=$(".margin").width();1280==t?(s=4,d=280,c=24):t>=960?(s=3,d=280,c=30):768>t?s=1:(s=2,d=330,c=36)};r.length&&(f(),s>1&&($(window).resize(function(){f(),r.masonry({itemSelector:".box",columnWidth:d,gutterWidth:c})}),r.masonry({itemSelector:".box",columnWidth:d,gutterWidth:c}))),$("[data-src]").each(function(t,e){var n=$('<img alt="'+$(e).attr("data-alt")+'" src="'+$(e).attr("data-src")+'" />');$(e).replaceWith(n)});var g=$(".kdp--single");if(g.length&&setInterval(function(){var t=g.find(".row"),e,n;t.each(function(t,n){return $(n).hasClass("toggle")?(e=t,!1):void 0}),n=e+1===t.length?0:e+1,$(t[e]).removeClass("toggle"),$(t[n]).addClass("toggle")},5e3),$.fancybox&&!$("body").hasClass("smartphone")&&($(".entry a").each(function(t,e){e.href.match(/(jpe?g|gif|png)$/i)&&(e.rel="fancyboxGroup",$(e).next("wp-caption-text").length>0?e.title=$(e).next("wp-caption-text").text():$(e).find("img").length>0&&(e.title=$(e).find("img").attr("alt")))}),$(".entry a[rel=fancyboxGroup]").fancybox({prevEffect:"none",nextEffect:"none",closeBtn:!1,helpers:{thumbs:{width:50,height:50},buttons:{}}}),w=700,h=$(window).height()-100,title=!0,$(".ebook-read-more a").fancybox({autoDimensions:!1,centerOnScroll:!0,height:h,width:w,titleShow:title,titlePosition:"inside"})),t(),$(window).resize(t),$("#to-top a").click(function(t){if(t.preventDefault(),$("html").scrollTop()>0)var e=$("html");else if($("body").scrollTop()>0)var e=$("body");e.animate({scrollTop:0},"fast")}),$(window).scroll(function(){$(this).scrollTop()<=28+$("#navi").height()?"none"!==$("#to-top").css("display")&&$("#to-top").fadeOut():"none"===$("#to-top").css("display")&&$("#to-top").fadeIn()}),$("body").hasClass("smartphone")){var p=null;$(".ebook-read-more a").click(function(t){t.preventDefault();var e,n,a,i,o;if(a=$(window).width(),i=window.innerHeight?window.innerHeight:$(window).height(),e=$(window).scrollTop(),o=40,null===p){p=$(document.createElement("div")).addClass("ebook-more-modal").css({top:n+e,left:0,width:a,height:i-o,paddingTop:o,display:"none"});var r=$(document.createElement("div")).addClass("ebook-more-title sans").text($(this).attr("title")),s=$(document.createElement("a")).addClass("button").addClass("ebook-more-close").text("×").attr("href","#");p.append(r).append(s).appendTo($("body")),s.click(function(t){t.preventDefault(),p.css("display","none"),$("#ebook-more-content").css({height:"auto"}).prependTo($(".ebook-more"))})}p.css("top",e).fadeIn(),$("#ebook-more-content").css({height:i-o-20}).prependTo(p)});var u=$("#book-shelf .lwp-table");if(u.length>0){var m=$('<div class="entry"></div>');m.dialog({autoOpen:!1,title:"決済情報詳細",modal:!0,position:["center","center"],width:300,maxHeight:window.innerHeight-56,resizable:!1}),u.find("tbody tr").click(function(t){var e="<table><tbody>";for(i=0,l=$(this).find("td").length;i<l;i++)e+="<tr><th>"+$(this).parents("table").find("thead th:eq("+i+")").text()+"</th><td>"+$(this).find("td:eq("+i+")").html()+"</td></tr>";e+="</tbody></table>",m.html(e),m.dialog("open")})}}var v=$("#tip-container");void 0!==document.ontouchstart?($(".tip, abbr, acronym, q").click(e),v.find("button").click(function(){v.fadeOut("fast"),$(this).removeClass("tip-toggle")}),v.addClass("touch")):$(".tip, abbr, acronym, q").hover(e).mousemove(function(t){var e=offsetX=10,n=posX=0;n=window.innerHeight-t.screenY<200?t.pageY-8*e-v.height():t.pageY-e,window.innerWidth-t.screenX<300?posX=t.pageX-3*offsetX-v.width():posX=t.pageX+offsetX,v.css({top:n,left:posX})})}),function($){$.event.add(window,"load",function(){$(".twitter-tweet-rendered").each(function(t,e){$(e).attr("style","").removeClass("twitter-tweet-rendered").addClass("fumiki-twitter-rendered")})})}(jQuery);